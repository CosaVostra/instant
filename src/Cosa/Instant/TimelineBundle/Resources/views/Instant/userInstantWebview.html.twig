{% extends '::webview.html.twig' %}

{% block body -%}
    <div id="tweet_column2" class="block last">
      <button onclick="refreshTimeline();" style="float:right;">refresh</button>
      <div class="block-title">
        Timeline
      </div>
      <div id="tweet_list2" class="block-content" style="height:371px;overflow-y:auto;overflow-x:hidden;">
        {% for tweet in tweets %}
          {% include 'CosaInstantTimelineBundle:Instant:tweet_bdd.html.twig' with {'tweet': tweet, 'draggable': false, 'editable': false} %}
        {% endfor %}
      </div>
    </div>
{% endblock %}

{% block javascripts %}
  <script type="text/javascript">
    function refreshTimeline()
    {
      $.ajax({
        type: "POST",
        url: "{{path('instant_refresh_timeline',{instant_id:instant.id})}}",
        data: {
          'editable':false,
        }
      })
      .done(function( retour ) {
        if(retour.retour){
          $('#tweet_list2').html(retour.html);
          var msg = $('<div class="flash-message flash-notice">Timeline refreshed !</div>');
        }else{
          var msg = $('<div class="flash-message flash-error">'+retour.retour+'</div>');
        }
        $('#flash-messages').append(msg);
        msg.delay(3000).fadeOut(1000);
      });
      return false;
    }
  </script>
{% endblock %}
