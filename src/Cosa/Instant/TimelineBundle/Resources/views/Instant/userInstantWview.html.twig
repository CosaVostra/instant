<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="shortcut icon" href="{{ asset('favicon.png') }}">

    <title>Fixed Top Navbar Example for Bootstrap</title>

    <!-- Bootstrap core CSS -->
    <link href="{{ asset('css/bootstrap2.min.css') }}" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="{{ asset('css/webview.css') }}" rel="stylesheet">

    <link rel="stylesheet" href="{{ asset('css/lightbox.css') }}" media="screen" />
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>

  <body>

    <!-- Fixed navbar -->
    <div class="navbar navbar-default navbar-fixed-top" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <span class="navbar-brand">{{ instant.title }}</span>
          <div class="navbar-logo"><img src="{{ asset('images/pre-logo.png') }}" alt="Instant"></div>
        </div>
        <div class="navbar-collapse collapse">
          {{ instant.description }} 
          <ul class="nav navbar-nav">
            <li><a href="#about">About</a></li>
            <li><a href="#contact">Contact</a></li>
          </ul>
          <ul class="nav navbar-nav navbar-right">
            <li><a href="../navbar/">Default</a></li>
            <li><a href="../navbar-static-top/">Static top</a></li>
          </ul>
        </div><!--/.nav-collapse -->
      <div class="pre-iphone-nav-full">
        <div id="tab1" class="pre-iphone-nav-tab-selected" onclick="$('#whotofollow_list').hide();$('#tweet_list2').show();$(this).attr('class', 'pre-iphone-nav-tab-selected');$('#tab2').attr('class', 'pre-iphone-nav-tab-not-selected');" >
          {% trans %}Timeline{% endtrans %}
        </div>
        <div id="tab2" class="pre-iphone-nav-tab-not-selected" onclick="$('#tweet_list2').hide();$('#whotofollow_list').show();$(this).attr('class', 'pre-iphone-nav-tab-selected');$('#tab1').attr('class', 'pre-iphone-nav-tab-not-selected');">
          {% trans %}Who to follow{% endtrans %}
        </div>
        <div style="clear:both;"></div>
      </div>
      </div>
    </div>

    <div class="container">

        <div id="tweet_list2" class="block-content" style="overflow-y:auto;overflow-x:hidden;">
          {% include 'CosaInstantTimelineBundle:Instant:tweetList.html.twig' with {'tweets': tweets, 'draggable': false, 'editable': false, 'instant': instant, 'off': 0, 'nb': 100, 'icons': true} %}
        </div>

        <div id="whotofollow_list" style="display:none;overflow-y:auto;overflow-x:hidden; background: white;" class="block-content">
          {% for twitto in twittos %}
            <div class=  "content-box-pre-full">
              <a href="http://twitter.com/{{ twitto.user.twitterUsername }}" title="{{ twitto.user.twitterRealname }}">
                <img src="{{ twitto.user.profileImageUrl }}" width="48" height="48" class="twitter-img">
              </a>
              <a href="http://twitter.com/{{ twitto.user.twitterUsername }}">{{ twitto.user.twitterRealname }}</a><span class="tweet_name">@{{ twitto.user.twitterUsername }}</span>
              <div class="tweet_icons3">
                <a href="https://twitter.com/intent/user?user_id={{ twitto.user.twitterId }}"><span class="icon icon-tweet-add"></span></a>
              </div><br />
              {{ twitto.user.twitterDescription | customlink | raw }}
              <br />
              {{ twitto.description | customlink | raw }}
            </div>
          {% endfor %}
        </div>

    <div id="footer" class="navbar-fixed-bottom">
      <div class="container">
        <p class="text-muted">Instant by <a href="http://twitter.com/{{ instant.user.twitterUsername }}" target="_blank">{{ instant.user.twitterRealname }}</a><br/>
        Powered by Instant
        </p>
      </div>
    </div>

    </div> <!-- /container -->

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <script src="{{ asset('js/bootstrap.min.js') }}"></script>
    <script type="text/javascript" src="//platform.twitter.com/widgets.js"></script>
    <script src="{{ asset('js/jquery-1.11.0.min.js') }}"></script>
    <script src="{{ asset('js/lightbox-2.6.min.js') }}"></script>
    <script type="text/javascript">
      $('.tweetmedia').each(function(){$(this).css('maxHeight',$(this).css('width'));});
      function searchFrom(username)
      {
        return true;
      }
      function getNbNewTweets()
      {
        $.ajax({
          type: "POST",
          url: "{{path('instant_nb_new_tweets',{instant_id:instant.id})}}",
          data: {
            {% if tweets|length > 0 %}
              'last': $('.tweet_id.hidden:first').html(),
            {% endif %}
          }
        })
        .done(function( retour ) {
          $('#nbnewtweets').remove();
          if(retour['retour']){
            if(retour['nb']!='0'){
              $('#tweet_list2').prepend('<div id="nbnewtweets" onclick="refreshTimeline();" title="click to refresh">'+retour['nb']+' new Tweets !</div>');
            }
          }else{
            //alert('{% trans %}Problem occured{% endtrans %}');
          }
        });
      }
      setInterval(function() {
        getNbNewTweets();
      }, 10000);
      function moreTweets(id,off,nb)
      {
        $('.more_tweets').hide();
        $.ajax({
          type: "POST",
          url: "{{path('instant_more_tweets',{instant_id:instant.id})}}",
          data: {
            'off': off,
            'nb': nb,
            'icons': 'true',
          }
        })
        .done(function( retour ) {
          $('#tweet_list2').append(retour);
        });
      }
      function refreshTimeline()
      {
        $.ajax({
          type: "POST",
          url: "{{path('instant_refresh_timeline',{instant_id:instant.id})}}",
          data: {
            'editable':false,
          }
        })
        .done(function( retour ) {
          if(retour.retour){
            $('#tweet_list2').html(retour.html);
            var msg = $('<div class="flash-message flash-notice">{% trans %}Timeline refreshed{% endtrans %} !</div>');
          }else{
            var msg = $('<div class="flash-message flash-error">'+retour.retour+'</div>');
          }
          $('#flash-messages').append(msg);
          msg.delay(3000).fadeOut(1000);
        });
        return false;
      }
    </script>
  </body>
</html>

